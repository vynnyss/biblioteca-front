<section class="cadastro-section">
	<form class="cadastro-form" (ngSubmit)="onSubmit(form)" #form="ngForm">
		<button *ngIf="isEditandoOutroCliente || isCliente()" class="btn btn-voltar" type="button" (click)="voltar()">← Voltar</button>
		<div *ngIf="loading" class="info-msg">Carregando seus dados...</div>
		<div *ngIf="!loading && loadError" class="error-msg">{{ loadError }}</div>
		<h2>{{ isEditandoOutroCliente ? 'Editar Cliente' : 'Atualizar cadastro' }}</h2>

		<label for="nome">Nome completo:</label><br>
		<input type="text" id="nome" name="nome" [(ngModel)]="user.nome" required><br>

		<label for="cpf">CPF:</label><br>
		<input
			type="text"
			id="cpf"
			name="cpf"
			maxlength="14"
			(input)="mascaraCPF($event)"
			placeholder="000.000.000-00"
			[(ngModel)]="user.cpf"
			required><br>

		<label for="dtNascimento">Data de Nascimento:</label><br>
		<input type="date" id="dtNascimento" name="dtNascimento" [(ngModel)]="user.dtNascimento" required><br>

		<label for="sexo">Sexo:</label><br>
		<select id="sexo" name="sexo" [(ngModel)]="user.sexo" required>
			<option value="">Selecione</option>
			<option value="MASCULINO">Masculino</option>
			<option value="FEMININO">Feminino</option>
			<option value="OUTRO">Outro</option>
		</select><br>

		<label for="email">E-mail:</label><br>
		<input type="email" id="email" name="email" [(ngModel)]="user.email" required><br>

		<label for="telefone">Telefone:</label><br>
		<input 
			type="tel" 
			id="telefone" 
			name="telefone" 
			[(ngModel)]="user.telefone" 
			(input)="mascaraTelefone($event)"
			pattern="[0-9]*" 
			minlength="10" 
			maxlength="11" 
			placeholder="(00) 00000-0000"
			required
			#telefoneInput="ngModel"><br>
		<span *ngIf="telefoneInput.invalid && telefoneInput.touched" style="color: red; font-size: 0.85em;">
			Telefone deve conter apenas números (10-11 dígitos)
		</span><br>

		<label for="Endereco">Endereço:</label><br>
		<input type="text" id="Endereco" name="Endereco" [(ngModel)]="user.endereco.nomeLogradouro" required><br>

		<label for="Numero">Número:</label><br>
		<input type="text" id="Numero" name="Numero" [(ngModel)]="user.endereco.numero" required><br>

		<label for="Complemento">Complemento:</label><br>
		<input type="text" id="Complemento" name="Complemento" [(ngModel)]="user.endereco.complemento"><br>

		<label for="Bairro">Bairro:</label><br>
		<input type="text" id="Bairro" name="bairro" maxlength="50" required [(ngModel)]="user.endereco.bairro"><br>

		<label for="Cidade">Cidade:</label><br>
		<input type="text" id="Cidade" name="cidade" maxlength="50" required [(ngModel)]="user.endereco.cidade"><br>

		<label for="idEstado">Estado (UF):</label><br>
		<select id="idEstado" name="idEstado" [(ngModel)]="user.endereco.idEstado" required>
			<option value="">Selecione um estado</option>
			<option *ngFor="let estado of estados" [value]="estado.idEstado">{{ estado.nome }}</option>
		</select><br>

		<label for="CEP">CEP:</label><br>
		<input type="text" id="CEP" name="cep" maxlength="8" placeholder="00000-000" required [(ngModel)]="user.endereco.cep"><br>

		<label for="senha">Senha:</label><br>
		<input type="password" id="senha" name="senha" [(ngModel)]="user.senha" placeholder="Digite sua senha ou uma nova senha" autocomplete="new-password"><br>

		<div class="cadastro-buttons">
			<button type="button" class="btn btn-cancelar" (click)="cancelar()">Cancelar</button>
			<button type="submit" class="btn btn-salvar">Salvar</button>
		</div>
	</form>
</section>

